<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>House Pong - 615 Realty Guy</title>
    <style>
        /* General Styles */
        body {
            font-family: 'Futura', sans-serif;
            background-color: #000000;
            color: #d2b56c;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        /* Home Button */
        .home-button {
            margin-top: 10px;
        }

        .home-button a {
            color: #d2b56c;
            text-decoration: none;
            font-size: 1rem;
            padding: 5px 10px;
            border-radius: 5px;
            transition: 0.3s;
        }

        .home-button a:hover {
            color: #feee9f;
        }

        /* Game Styles */
        canvas {
            background: url('https://i.imgur.com/CuZ9Mfx.png') no-repeat center center;
            background-size: cover;
            display: block;
            margin: auto;
            border: 2px solid #d2b56c;
            max-width: 100%;
            height: auto;
        }

        /* Touch Controls */
        .touch-controls {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        .touch-button {
            background: #d2b56c;
            color: #000;
            font-size: 1.2rem;
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            touch-action: manipulation;
        }
        .touch-button:active {
            background: #feee9f;
        }

        /* Start Button Overlay */
        .start-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
        }

        .start-button {
            background: #d2b56c;
            color: #000;
            font-size: 1.5rem;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }

        .start-button:hover {
            background: #feee9f;
        }

        /* Countdown Overlay */
        .countdown-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
            font-size: 3rem;
            color: #d2b56c;
        }

        /* Rebound Counter Styles */
        .rebound-counter {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5rem;
            color: #d2b56c;
        }

        /* Pause Button Styles */
        .pause-button {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: #d2b56c;
            color: #000;
            font-size: 1.2rem;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }
        .pause-button:hover {
            background: #feee9f;
        }
    </style>
</head>
<body>
    <div class="home-button">
        <a href="https://615realtyguy.com">üè† Home</a>
    </div>
    <h1>House Pong üè°üèì</h1>
    <p>Use the arrow keys (‚¨ÜÔ∏è‚¨áÔ∏è) or touch buttons for mobile users to bounce the contract back & forth</p>
<canvas id="pongCanvas" tabindex="0"></canvas>
    
    <div class="start-overlay" id="startOverlay">
        <button class="start-button" id="startButton">Start Game</button>
    </div>

    <div class="countdown-overlay" id="countdownOverlay" style="display: none;"></div>

    <div class="touch-controls">
        <button class="touch-button" id="upBtn">‚¨ÜÔ∏è</button>
        <button class="touch-button" id="downBtn">‚¨áÔ∏è</button>
    </div>

    <div class="rebound-counter" id="reboundCounter">Rebounds: 0</div>

    <button class="pause-button" id="pauseButton">Pause</button>
    
<script>
    const canvas = document.getElementById("pongCanvas");
    const ctx = canvas.getContext("2d");
    const startButton = document.getElementById("startButton");
    const startOverlay = document.getElementById("startOverlay");
    const countdownOverlay = document.getElementById("countdownOverlay");
    const reboundCounter = document.getElementById("reboundCounter");
    const pauseButton = document.getElementById("pauseButton");

    let gameStarted = false;
    let playerReboundCount = 0;
    let isPaused = false;

    let canvasWidth, canvasHeight;
    let paddleWidth, paddleHeight;
    let leftPaddleY, rightPaddleY;
    let ballX, ballY, ballSpeedX, ballSpeedY;

    // Unified input state
    let moveUp = false;
    let moveDown = false;

    function resizeCanvas() {
        canvasWidth = Math.max(320, window.innerWidth * 0.9);
        canvasHeight = Math.max(240, window.innerHeight * 0.6);
        canvas.width = canvasWidth;
        canvas.height = canvasHeight;

        paddleWidth = canvasWidth * 0.03;
        paddleHeight = canvasHeight * 0.2;
        resetGame();
    }

    function resetGame() {
        leftPaddleY = (canvasHeight - paddleHeight) / 2;
        rightPaddleY = (canvasHeight - paddleHeight) / 2;
        ballX = canvasWidth / 2;
        ballY = canvasHeight / 2;
        ballSpeedX = canvasWidth * 0.005;
        ballSpeedY = canvasHeight * 0.005;
    }

    function drawRect(x, y, width, height, emoji) {
        ctx.font = `${canvasWidth * 0.05}px Arial`;
        ctx.fillText(emoji, x, y + height / 2);
    }

    function drawBall(x, y, emoji) {
        ctx.font = `${canvasWidth * 0.04}px Arial`;
        ctx.fillText(emoji, x, y);
    }

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawRect(20, leftPaddleY, paddleWidth, paddleHeight, "üè°");
        drawRect(canvas.width - 40 - paddleWidth, rightPaddleY, paddleWidth, paddleHeight, "üè°");
        drawBall(ballX, ballY, "üìÑ");
    }

    function handlePaddleInput() {
        // Always allow paddle movement (even before start or while paused)
        const paddleStep = Math.max(1, canvasHeight * 0.0375);
        if (moveUp && rightPaddleY > 0) {
            rightPaddleY = Math.max(0, rightPaddleY - paddleStep);
        }
        if (moveDown && rightPaddleY < canvas.height - paddleHeight) {
            rightPaddleY = Math.min(canvas.height - paddleHeight, rightPaddleY + paddleStep);
        }
    }

    function updateBallAndAI() {
        // Only the ball/AI are gated by start & pause
        if (!gameStarted || isPaused) return;

        ballX += ballSpeedX;
        ballY += ballSpeedY;

        if (ballY <= 0 || ballY >= canvas.height) {
            ballSpeedY = -ballSpeedY;
        }

        const rightPaddleX = canvas.width - 40 - paddleWidth;

        const hitLeft =
            ballX <= 40 &&
            ballY >= leftPaddleY &&
            ballY <= leftPaddleY + paddleHeight;

        const hitRight =
            ballX >= rightPaddleX &&
            ballY >= rightPaddleY &&
            ballY <= rightPaddleY + paddleHeight;

        if (hitLeft || hitRight) {
            ballSpeedX = -ballSpeedX;

            if (hitRight) {
                playerReboundCount++;
                reboundCounter.textContent = `Rebounds: ${playerReboundCount}`;
                if (playerReboundCount % 5 === 0) {
                    ballSpeedX *= 1.1;
                    ballSpeedY *= 1.1;
                }
            }
        }

        // Left paddle AI with a bit of noise
        const baseSpeed = canvasHeight * 0.005;
        const aiSpeed = baseSpeed + Math.random() * canvasHeight * 0.002;
        const errorMargin = Math.random() * canvasHeight * 0.02 - canvasHeight * 0.01;
        const reactionDelay = Math.random() > 0.7 ? aiSpeed : 0;

        if (leftPaddleY + paddleHeight / 2 < ballY + errorMargin + reactionDelay) {
            leftPaddleY = Math.min(canvasHeight - paddleHeight, leftPaddleY + aiSpeed);
        } else {
            leftPaddleY = Math.max(0, leftPaddleY - aiSpeed);
        }
    }

    function gameLoop() {
        handlePaddleInput();     // <- runs every frame
        updateBallAndAI();       // <- runs only when started & not paused
        draw();
        requestAnimationFrame(gameLoop);
    }

    function startCountdown() {
        let countdown = 3;
        countdownOverlay.style.display = "block";
        countdownOverlay.textContent = countdown;

        const countdownInterval = setInterval(() => {
            countdown--;
            if (countdown > 0) {
                countdownOverlay.textContent = countdown;
            } else {
                clearInterval(countdownInterval);
                countdownOverlay.style.display = "none";
                gameStarted = true;
            }
        }, 1000);
    }

    // Start button
    startButton.addEventListener("click", function () {
        startOverlay.style.display = "none";
        startCountdown();
        // Keep focus on canvas for immediate key input
        setTimeout(() => canvas.focus(), 0);
    });

    // Touch + Mouse + Pointer helpers for on-screen buttons
    const upBtn = document.getElementById("upBtn");
    const downBtn = document.getElementById("downBtn");

    function bindPress(el, setter) {
        // Pointer events cover mouse + touch on modern browsers
        el.addEventListener("pointerdown", (e) => {
            e.preventDefault();
            setter(true);
        });
        el.addEventListener("pointerup", (e) => {
            e.preventDefault();
            setter(false);
        });
        el.addEventListener("pointerleave", () => setter(false));

        // Fallback touch (older Safari)
        el.addEventListener("touchstart", (e) => { e.preventDefault(); setter(true); }, { passive: false });
        el.addEventListener("touchend",   (e) => { e.preventDefault(); setter(false); }, { passive: false });

        // Fallback mouse (older browsers)
        el.addEventListener("mousedown", (e) => { e.preventDefault(); setter(true); });
        window.addEventListener("mouseup", () => setter(false));
    }

    bindPress(upBtn,   (v) => { moveUp = v; });
    bindPress(downBtn, (v) => { moveDown = v; });

    // Keyboard controls (ArrowUp/Down, W/S) ‚Äî support both code & key
    function isUp(ev) {
        return ev.code === "ArrowUp" || ev.code === "KeyW" || ev.key === "ArrowUp" || ev.key === "w" || ev.key === "W";
    }
    function isDown(ev) {
        return ev.code === "ArrowDown" || ev.code === "KeyS" || ev.key === "ArrowDown" || ev.key === "s" || ev.key === "S";
    }

    window.addEventListener("keydown", (e) => {
        if (isUp(e) || isDown(e)) e.preventDefault();
        if (isUp(e)) moveUp = true;
        if (isDown(e)) moveDown = true;
    }, { passive: false });

    window.addEventListener("keyup", (e) => {
        if (isUp(e) || isDown(e)) e.preventDefault();
        if (isUp(e)) moveUp = false;
        if (isDown(e)) moveDown = false;
    }, { passive: false });

    // Pause button
    pauseButton.addEventListener("click", function () {
        isPaused = !isPaused;
        pauseButton.textContent = isPaused ? "Resume" : "Pause";
        canvas.focus();
    });

    // Ensure canvas gets focus so keys work immediately
    window.addEventListener("load", () => {
        canvas.focus();
    });
    canvas.addEventListener("click", () => canvas.focus());

    window.addEventListener("resize", resizeCanvas);

    resizeCanvas();
    gameLoop();
</script>


</body>
</html>
